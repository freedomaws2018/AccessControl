<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{comm/layout}">
<head>
<meta charset="UTF-8">
<title>Log</title>
</head>

<body layout:fragment="content">
  <script type="text/javascript">
  $().ready(function(){
    $("#auto_location").autocomplete({
        minLength: 0,
        source: function(request,response){
          $.ajax({
            method: 'post',
            url: '/location/autocomplete/getAll',
            data: request,
            dataType: 'json',
            success: function(result){
              var data = [];
            result.forEach((d) => {
                data.push({ label: d.name, value: d.name, object: d });
            });
              response(data);
            }
          });
        },
        select: function(event,ui){
          var obj = ui.item.object;
          $("#locationId").val(obj.id);
          $("#location_address").text(obj.address);
        }
      })
      .blur(function(){
        $(this).autocomplete('enable');
      })
      .focus(function () {
        $(this).autocomplete('search', '');
      });
  })
  </script>
  
  <form th:action="@{/line/log/list}" >
    <div class="row"> <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-6"> <div class="card">
      <div class="card-header" toggleId='a'>
        <span class="glyphicon glyphicon-align-justify"></span>查詢
      </div>
<!--       <span th:text="${param}"></span> -->
      <script th:inline="javascript">
       	console.log([[${logWf8266s}]].valueOf())
</script>
      <div class="card-body" toggleId='a' style="display: none;" >
        <table class="table table-hover table-responsive-sm">
          <tbody>
            <tr>
              <th>時間區間</th>
              <td>
                <input name="begDt" th:value="${param.begDt}" /> ~ 
                <input name="endDt" th:value="${param.begDt}" />
              </td>
            </tr>
            <tr>
              <th>Location</th>
              <td>
                <input type="text" id="locationId" name="locationId" />
                <input type="text" id="auto_location" />
                <span id="location_address"></span>
              </td>
            </tr>
            <tr>
              <th>LineUser</th>
              <td>
                <input type="text" name="employeeId" />
                <input type="text" id="auto_employee" />
              </td>
            </tr>
            <tr>
              <th>TriggerText</th>
              <td>
                <input type="text" name="triggerText" />
                <input type="text" id="auto_trigger" />
              </td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="4">
                <input type="submit" /> <a href="javascript:;">下載(X)</a>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div> </div> </div>
  </form>
  <div class="row"> <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-6"> <div class="card">
    <div class="card-header" toggleId='b'>
      <span class="glyphicon glyphicon-align-justify"></span>列表
    </div>
    <div class="card-body" toggleId='b'>
      <table class="table table-hover table-responsive-sm">
        <thead class="center">
          <tr>
            <th scope="col">時間</th>
            <th scope="col">姓名</th>
            <th scope="col">行為</th>
          </tr>
        </thead>
        <tbody class="center">
          <tr th:each="log:${logWf8266s}">
            <th>
              <span th:text="${#temporals.format(log.createDate, 'yyyy/MM/dd HH:mm:ss.SSS')}"></span>
            </th>
            <td>
              <span th:text="${log.lineUser?.userName}"></span>
            </td>
            <td>
              <span  th:text="${log.wf8266Detail?.name}"></span>
            </td>
          </tr>
        </tbody>
      </table>
      <div th:if="${logWf8266s.totalPages gt 1}" >
        <div th:replace="~{comm/page :: page01(entity=${logWf8266s})}"></div>
      </div>
    </div>
  </div> </div> </div>
	
</body>
</html>