<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{comm/layout}">
<head><meta charset="UTF-8"></head>

<body layout:fragment="content">
  <title th:if="${funcType eq 'view' }">LineUser - 檢視</title>
  <title th:if="${funcType eq 'edit' }">LineUser - 修改</title>
  <script th:inline="javascript" type="text/javascript">
//   $().ready(function(){
//   	dateTimePicke("datetimePicker","begDt","endDt");
//     location_change();
  	
//   	$("#submit_btn").click(function(){
//   	  var jsonData = $("#line_user_form").toJson();
//   	  console.log(jsonData);
//   	  $.ajax({
//         method: 'post',
//         url: '/line/user/save',
//         data: jsonData,
//         dataType: 'json',
//         success: function(result){
//           if(result.status === 'success'){
//             window.location.replace("/line/user/view/" + result.data.userId);
//           }else{
//             console.log(result);
//           }
//         },
//         error: function(error){
//           console.log(a,b,c)
//         }
//       });
//   	});
  	
//   });
  
//   var location_change = function(){
//     var locationId = $("#locationId").find(":selected").val();
//     $("#locationDetailName").prop("disabled",true);
//     $.ajax({
//       method: 'POST',
//       url: '/location/getLocationDetailByLocationId',
//       data: { locationId : locationId },
//       dataType: 'json',
//       success: function(details){
// //         console.log(details)
//         $("#locationDetailName option").remove();
//         $("#locationDetailName").append(new Option("請選擇",''));
//         $.each(details,function(index,detail) {
//           $("#locationDetailName").append(new Option(detail.name,detail.name));
//         });
//         $("#locationDetailName").val([[${user.locationDetailName}]]);
//         if([[${funcType}]] != 'view'){
//           $("#locationDetailName").prop("disabled",false);
//         }
//       }
//     });
//   }
  </script>
  <div class="row">
  <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-8">
  </div>
  </div>
<!--  th:action="@{/line/user/save}" method="post" -->
  <form id="line_user_form">
    <div class="row"><div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"><div class="card">
        <div class="card-header" >
          <span class="glyphicon glyphicon-align-justify"></span>
          <span th:if="${funcType eq 'view'}">LineUser - 檢視
            <a th:href="@{/line/user/edit/{userId}(userId=${user.userId})}" class="btn btn-success a-btn-second btn-sm"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span>修改 </a>
          </span>
          <span th:if="${funcType eq 'edit'}">LineUser - 修改</span>
        </div>
        <div class="card-body" >  
        
          <div class="row">
          
            <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-4">
              <label class="font-weight-bold">使用者編號</label><br>
              <input th:if="${funcType eq 'edit' || funcType eq 'view'}" disabled class="form-control" name="userId" th:value="${user.userId}" />
            </div>
            
            <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-4">
              <label class="font-weight-bold">使用者名稱</label><br>
              <input th:if="${funcType eq 'edit' || funcType eq 'view'}" th:disabled="${funcType eq 'view'}" class="form-control" id="userName" name="userName" th:value="${user.userName}"/>
            </div>
  
<!--             <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-9"> -->
<!--               <label class="font-weight-bold">使用據點與細項</label> -->
<!--               <div class="row"> -->
<!--                 <div class="col-6" th:if="${funcType eq 'edit' || funcType eq 'view'}" > -->
<!--                   <select th:disabled="${funcType eq 'view'}" class="form-control select-sm" name="locationId" id="locationId" th:onchange="|location_change()|" > -->
<!--                     <option value="">請選擇</option> -->
<!--                     <option th:each="location:${allLocation}" th:object="${location}" th:value="*{id}" th:text="|*{name} : *{address}|" th:selected="*{id} == ${user.locationId}"></option> -->
<!--                   </select> -->
<!--                 </div> -->
<!--                 <div class="col-6" > -->
<!--                   <div th:if="${funcType eq 'edit' || funcType eq 'view'}" > -->
<!--                     <select th:disabled="${funcType eq 'view'}" class="form-control select-sm" name="locationDetailName" id="locationDetailName" > -->
<!--                       <option value="">請先選擇據點</option> -->
<!--                       <option th:each="location:${allLocation}" th:object="${location}" th:value="*{id}" th:text="|*{name} : *{address}|" th:selected="*{id} == ${user.locationId}"></option> -->
<!--                     </select> -->
<!--                   </div> -->
<!--                 </div> -->
<!--               </div> -->
<!--             </div> -->

<!--                   <optgroup label="Swedish Cars"> -->
<!--                     <option th:each="menu:${allRichMenu}" th:object="${menu}" th:value="*{richMenuId}" th:text="*{name}" th:selected="*{richMenuId} == ${user.richMenuId}"></option> -->
<!--                   </optgroup> -->
            
            <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-4">
              <label class="font-weight-bold">當前使用選單</label>
              <div th:if="${funcType eq 'edit' || funcType eq 'view'}" >
                <select th:disabled="${funcType eq 'view'}" class="form-control select-sm" name="richMenuId">
                  <option value="">請選擇</option>
                  <script th:inline="javascript">
                  	var locs = [[${allLocation}]];
//                   	var RMS = [[${allRichMenu}]];
//                   	console.log(Loc , RMS);
//                   	var lastRM;
                  	$.each(locs , function(index,loc){
                  	  var locDet = loc.details;
                  	  if(locDet.length > 0){
                  	    document.write("<optgroup label='" + loc.name + "'>");
                  	    $.each(loc.details,function(index , det){
                  	      if(det.richMenuId){
                  	        if([[${user.richMenuId}]] == det.richMenuId){
                  	      	  document.write("<option value='" + det.richMenuId + "' selected>" + det.name + "</option>");
                  	        }else{
                  	      	  document.write("<option value='" + det.richMenuId + "'>" + det.name + "</option>");
                  	        }
                  	      }else{
                  	        document.write("<option value='" + det.richMenuId + "' disabled>" + det.name + "</option>");
                  	      }
                  	    });
                  	    document.write("</optgroup>");
                  	  }
                  	});
                  </script>
                </select>
              </div>
            </div>
   
            <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-3">
              <label class="font-weight-bold">是否啟用</label><br>
              <div th:if="${funcType eq 'edit' || funcType eq 'view'}">
                <label><input type="radio" th:disabled="${funcType eq 'view'}" id="isUseTrue" name="isUse" value="true" th:checked="${user.isUse}" />是</label>
                <label><input type="radio" th:disabled="${funcType eq 'view'}" id="isUseFalse" name="isUse" value="false" th:checked="${not user.isUse}"/>否</label>
              </div>
            </div> 
            
            <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-3">
              <label class="font-weight-bold">設為管理員</label><br>
              <div th:if="${funcType eq 'edit' || funcType eq 'view'}">
                <label><input type="radio" th:disabled="${funcType eq 'view'}" id="isAdminTrue" name="isAdmin" value="true" th:checked="${user.isAdmin}" />是</label>
                <label><input type="radio" th:disabled="${funcType eq 'view'}" id="isAdminFalse" name="isAdmin" value="false" th:checked="!${user.isAdmin}"/>否</label>
              </div>
            </div> 
            
            <div class="col-11 col-sm-11 col-md-11 col-lg-11 col-xl-6">
              <label class="font-weight-bold">有效時限</label><br>
              <input type="hidden" id="begDt" name="begDt" th:value="${#temporals.format(user.begDt, 'yyyy-MM-dd HH:mm')}" />
              <input type="hidden" id="endDt" name="endDt" th:value="${#temporals.format(user.endDt, 'yyyy-MM-dd HH:mm')}" />
              <input th:if="${funcType eq 'edit' || funcType eq 'view'}" th:disabled="${funcType eq 'view'}" id="datetimePicker" class="form-control" />
            </div>
      
          </div>
  
          <div class="row badge-margin justify-content-center hide-in-phone">
            <div class="badge badge-info text-wrap col-11 col-sm-11 col-md-11 col-lg-11 col-xl-4">
              <span th:text="|建立時間：  ${#temporals.format(user.createDate, 'yyyy/MM/dd HH:mm:ss')}|"></span>
            </div>&emsp;
            <div class="badge badge-info text-wrap col-11 col-sm-11 col-md-11 col-lg-11 col-xl-4">
              <span th:text="|修改時間：  ${#temporals.format(user.modifyDate, 'yyyy/MM/dd HH:mm:ss')}|"></span>
            </div>
          </div>
          
          <div class="row badge-margin justify-content-center show-on-phone">
            <div class="badge badge-info text-wrap col-11 col-sm-11 col-md-11 col-lg-11 col-xl-4">
              <span th:text="|建立時間：  ${#temporals.format(user.createDate, 'yyyy/MM/dd HH:mm:ss')}|"></span>
            </div>&emsp;
            <div class="badge badge-info text-wrap col-11 col-sm-11 col-md-11 col-lg-11 col-xl-4">
              <span th:text="|修改時間：  ${#temporals.format(user.modifyDate, 'yyyy/MM/dd HH:mm:ss')}|"></span>
            </div>
          </div>
          
          <div th:if="${funcType eq 'edit' || funcType eq 'add'}"><div class="line"></div></div>
          
          <div th:if="${funcType eq 'edit' || funcType eq 'add'}" class="row justify-content-center">
            <button type="button" id="submit_btn" class="btn btn-primary btn-sm">
              <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>送出
            </button>
          </div>
          
        </div>
    </div> </div> </div>
  </form>
</body>
</html>